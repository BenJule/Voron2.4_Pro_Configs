#####################################################################
#   Optimized Bed Mesh - Voron 2.4 R2 350mm
#   7x7 High-Resolution Mesh für beste First Layer
#####################################################################

[bed_mesh]
speed: 300                       # Schnelle Probe-Geschwindigkeit
horizontal_move_z: 10            # Sichere Höhe zwischen Messpunkten
mesh_min: 45, 45                 # Min Position (mit Rand)
mesh_max: 325, 325               # Max Position (mit Rand)
zero_reference_position: 175,175 # Center reference für Cartographer/Tap

# High Resolution Mesh
probe_count: 7, 7                # 7x7 = 49 Messpunkte (deutlich besser als 5x5)
algorithm: bicubic               # Bicubic für smoothes Mesh

# Fade Settings
fade_start: 0.6                  # Start fade bei 0.6mm
fade_end: 10.0                   # Komplettes fade bei 10mm
fade_target: 0                   # Fade zu 0 (flaches Bett)

# Mesh Interpolation
mesh_pps: 2, 2                   # Interpolations-Punkte (default, gut so)

# Relative Reference Index (wird automatisch berechnet für zero_reference_position)

#####################################################################
#   Bed Mesh Profile Management
#####################################################################

[gcode_macro BED_MESH_FULL]
description: Full 7x7 Bed Mesh (alle Punkte)
gcode:
    RESPOND MSG="Running Full Bed Mesh (7x7 = 49 points)..."
    BED_MESH_CALIBRATE ADAPTIVE=0
    RESPOND MSG="Full Bed Mesh complete!"

[gcode_macro BED_MESH_ADAPTIVE]
description: Adaptive Mesh (nur Druckbereich)
gcode:
    RESPOND MSG="Running Adaptive Bed Mesh..."
    BED_MESH_CALIBRATE ADAPTIVE=1
    RESPOND MSG="Adaptive Bed Mesh complete!"

[gcode_macro BED_MESH_FAST]
description: Schnelles 5x5 Mesh für Tests
gcode:
    RESPOND MSG="Running Fast Bed Mesh (5x5)..."
    BED_MESH_CALIBRATE MESH_MIN=45,45 MESH_MAX=325,325 PROBE_COUNT=5,5
    RESPOND MSG="Fast Bed Mesh complete!"

[gcode_macro BED_MESH_ULTRA]
description: Ultra High-Res 9x9 Mesh (Slow!)
gcode:
    RESPOND MSG="Running Ultra Bed Mesh (9x9 = 81 points, ~5min)..."
    BED_MESH_CALIBRATE MESH_MIN=45,45 MESH_MAX=325,325 PROBE_COUNT=9,9
    RESPOND MSG="Ultra Bed Mesh complete!"

[gcode_macro BED_MESH_INFO]
description: Zeige aktuelles Mesh Info
gcode:
    {% if printer.bed_mesh.profile_name %}
        RESPOND MSG="Active mesh: {printer.bed_mesh.profile_name}"
        RESPOND MSG="Mesh min: {printer.bed_mesh.mesh_min}"
        RESPOND MSG="Mesh max: {printer.bed_mesh.mesh_max}"
        RESPOND MSG="Probe count: {printer.bed_mesh.probed_matrix}"
    {% else %}
        RESPOND MSG="No active bed mesh loaded"
    {% endif %}
