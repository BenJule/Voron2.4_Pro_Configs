###########################
# Heater Settings - OPTIMIZED
# 230V, 750W Bed Heater
# 24v, 50W Hot-end Heater
###########################

#####################################################################
#   Bed Heater - Optimized for Fast Heating & Stability
#####################################################################

[heater_bed]
heater_pin: PA3
sensor_type: Generic 3950
sensor_pin: PF3

# PID Control (bereits gut kalibriert)
control: pid
pid_Kp: 37.653
pid_Ki: 1.050
pid_Kd: 337.466

# Power Settings - OPTIMIERT
max_power: 0.75                # Erhöht von 0.6 auf 0.75 (562W) für schnelleres Aufheizen
                               # Immer noch sicher, aber 25% schneller
min_temp: 0
max_temp: 120

# PWM Settings für sanftere Regelung
pwm_cycle_time: 0.0166         # 60Hz (optimal für 230V AC über SSR)
                               # Reduziert Temperatur-Overshoot

#####################################################################
#   Dragon HF Hotend - OPTIMIZED
#   PT1000 Sensor | 50W Heater | 24V
#####################################################################

[extruder]
# Extrusion Settings
step_pin: PE2
dir_pin: PE3
enable_pin: !PD4
rotation_distance: 22.4284412
gear_ratio: 50:10
microsteps: 32
full_steps_per_rotation: 200
nozzle_diameter: 0.400
filament_diameter: 1.75

# Extrusion Limits - OPTIMIZED
max_extrude_only_distance: 1400.0
max_extrude_only_velocity: 120
max_extrude_only_accel: 3000
max_extrude_cross_section: 5

# Heater Settings - Dragon HF
heater_pin: PA2
sensor_type: PT1000
sensor_pin: PF4
min_temp: 10
max_temp: 300
max_power: 1.0
min_extrude_temp: 190

# PID Control (optimiert durch PID Tuning @ 230C)
control: pid
pid_Kp: 22.598
pid_Ki: 1.245
pid_Kd: 102.540

# Pressure Advance - Dragon HF optimiert
pressure_advance: 0.045
pressure_advance_smooth_time: 0.040

#####################################################################
#   Verify Heater - Safety Configuration
#####################################################################

[verify_heater heater_bed]
max_error: 120                 # Standard: 120
                               # Erlaubt größere Temperaturabweichung vor Fehler
check_gain_time: 90            # Erhöht von 60 auf 90 Sekunden
                               # 230V Betten brauchen länger zum Stabilisieren
heating_gain: 2                # Mindestens 2°C in check_gain_time
                               # Verhindert false-positive Fehler bei hohen Temps
hysteresis: 5                  # ±5°C Toleranz
                               # Verhindert Fehler bei kleinen Schwankungen

[verify_heater extruder]
max_error: 120
check_gain_time: 20          # Hotend heizt schneller als Bed
heating_gain: 2
hysteresis: 5
